(this["webpackJsonpserverless-fullstack-app-website"]=this["webpackJsonpserverless-fullstack-app-website"]||[]).push([[0],{1:function(e,t,a){e.exports={container:"Auth_container__2I7ZI",containerInner:"Auth_containerInner__2Ad-D",containerLoading:"Auth_containerLoading__GK7aI",logo:"Auth_logo__cB8rF",formType:"Auth_formType__3Vam1",error:"Auth_error__1yPH3",success:"Auth_success__gCr7e",formTypeRegister:"Auth_formTypeRegister__34am6",formTypeSignIn:"Auth_formTypeSignIn__ZUGnB",formTypeActive:"Auth_formTypeActive__10X1I",form:"Auth_form__q4yyV",formField:"Auth_formField__1jV6M",formLabel:"Auth_formLabel__3eAsh",formInput:"Auth_formInput__1gOln",formError:"Auth_formError__1EE00",formButton:"Auth_formButton__3mJT5",forgotPassword:"Auth_forgotPassword__1SM6o",githubLink:"Auth_githubLink__2BpKa",successMessage:"Auth_successMessage__2YZBB",switchAuthType:"Auth_switchAuthType__33e61",switchButton:"Auth_switchButton__2YM2r",customButton:"Auth_customButton__1xR-3"}},10:function(e,t,a){e.exports={container:"Dashboard_container__1qbiH",containerInner:"Dashboard_containerInner__1UfLk",navigationContainer:"Dashboard_navigationContainer__39wa-",contentContainer:"Dashboard_contentContainer__wUDh-",welcomeMessage:"Dashboard_welcomeMessage__3B5nu",artwork:"Dashboard_artwork__1J6WL"}},18:function(e,t,a){e.exports={container:"Loading_container__Znt6o",pulse:"Loading_pulse__-Ma2O"}},19:function(e,t,a){e.exports=a(33)},32:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var r=a(0),o=a.n(r),n=a(16),s=a.n(n),i=a(7),l=a(2),c=a(8),m=a.n(c);class u extends r.Component{render(){return o.a.createElement("div",{className:"".concat(m.a.container," animateFadeIn")},o.a.createElement("div",{className:m.a.containerInner},o.a.createElement("div",{className:"".concat(m.a.heroArtwork," animateFlicker")},o.a.createElement("img",{draggable:"false",src:"./fullstack-app-artwork.png",alt:"serverless-fullstack-application"})),o.a.createElement("div",{className:"".concat(m.a.heroTitle)},o.a.createElement("img",{draggable:"false",src:"./fullstack-app-title.png",alt:"serverless-fullstack-application"})),o.a.createElement("div",{className:"".concat(m.a.heroDescription)},"Aplicaci\xf3n sin servidor en GCP con Cloud Build, Storage, Kubernetes y pruebas automatizadas con Jenkins"),o.a.createElement("div",{className:"".concat(m.a.containerCta)},o.a.createElement(i.b,{to:"/public/users/register"},o.a.createElement("button",{className:"buttonPrimaryLarge"},"Registro")),o.a.createElement(i.b,{to:"/public/users/login",className:"".concat(m.a.linkSignIn)},"Iniciar Sesion"))))}}var d=u,h=a(18),p=a.n(h);class g extends r.Component{constructor(e){super(e),this.state={}}async componentDidMount(){}render(){return o.a.createElement("div",{className:"".concat(this.props.className)},o.a.createElement("div",{className:"".concat(p.a.container)},o.a.createElement("img",{draggable:!1,alt:"Loading",src:"https://s3.amazonaws.com/dashboard.serverless.com/images/icon-serverless-framework.png"}),o.a.createElement("p",null,"loading...")))}}var _=a(1),f=a.n(_);const E={domains:{}};E.domains.frontend="http://localhost:3002",E.domains.api="http://localhost:3000",E.routes={register:"/public/users/register",login:"/public/users/login",userGet:"/protected/user"},E.method="POST";const b={domains:{}};b.domains.api="http://10.60.3.168:80";var v=b,w=a(12),y=a.n(w);const k=(e,t,a)=>{y.a.set("serverless",{userId:e,userEmail:t,userToken:a}),console.log("Sesi\xf3n guardada:",{userId:e,userEmail:t,userToken:a})},N=()=>{const e=y.a.get("serverless"),t=e?JSON.parse(e):null;return console.log("Sesi\xf3n recuperada:",t),t},I=async e=>(console.log("Calling requestApi from userGet with method: ".concat(v.method)),await A("userGet",v.method,null,{Authorization:"Bearer ".concat(e)})),A=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.method,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!(null===v||void 0===v||null===(e=v.domains)||void 0===e?void 0:e.api))throw new Error("Error: Falta el dominio de la API. Por favor, agrega el dominio de la API de tu backend Express.js sin servidor a esta aplicaci\xf3n front-end.");const n=v.routes[t];if(!n)throw new Error("Error: Ruta '".concat(t,"' no encontrada en la configuraci\xf3n."));const s="".concat(v.domains.api).concat(n);o=Object.assign({"Content-Type":"application/json"},o);const i=await fetch(s,{method:a.toUpperCase(),mode:"cors",cache:"no-cache",headers:o,body:r?JSON.stringify(r):null});if(!i.ok){const e=await i.json();throw new Error(e.error||"Fallo al obtener datos del servidor.")}return await i.json()};class C extends r.Component{constructor(e){super(e),this.state={loading:!1,formEmail:"",formPassword:"",formUsername:"",formRole:"",formError:""},this.handleFormInput=this.handleFormInput.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleRegisterClick=this.handleRegisterClick.bind(this),this.handleLoginClick=this.handleLoginClick.bind(this)}handleFormInput(e,t){t=t.trim();const a={};a[e]=t,this.setState(a)}async handleFormSubmit(e){e.preventDefault(),console.log("Formulario enviado"),this.setState({loading:!0});const{formEmail:t,formPassword:a,formUsername:r,formRole:o}=this.state;if(!t||!a)return this.setState({formError:"Correo electr\xf3nico y contrase\xf1a son obligatorios",loading:!1});try{v.domains.api;let e;if("register"===this.props.authType){if(!r||!o)return this.setState({formError:"Todos los campos son obligatorios",loading:!1});const n={email:t,password:a,username:r,role:o};e=await this.sendFormData(n,"register"),console.log("Token generado:",e);const s=await I(e.token);k(s.user.id,t,e.token),this.setState({loading:!1}),console.log("Redirigiendo a /public/users/login"),this.props.history.push("/public/users/login")}else if("login"===this.props.authType){e=await this.sendFormData({email:t,password:a},"login"),console.log("Token generado:",e);const r=await I(e.token);k(r.user.id,t,e.token),this.setState({loading:!1}),console.log("Redirigiendo a /dashboard"),this.props.history.push("/dashboard")}}catch(n){console.error("Error en la solicitud:",n),this.setState({formError:n.message||"Lo siento, ocurri\xf3 un error desconocido. Por favor, int\xe9ntalo de nuevo.",loading:!1})}}async sendFormData(e,t){try{return await A(t,v.method,e)}catch(a){throw console.error("Error en la solicitud:",a),a}}handleRegisterClick(){console.log("Redirigiendo a /public/users/register"),this.props.history.push("/public/users/register")}handleLoginClick(){console.log("Redirigiendo a /public/users/login"),this.props.history.push("/public/users/login")}render(){return o.a.createElement("div",{className:"".concat(f.a.container," animateFadeIn")},o.a.createElement("div",{className:f.a.containerInner},o.a.createElement(i.b,{to:"/",className:f.a.logo},o.a.createElement("img",{draggable:"false",src:"/fullstack-app-title.png",alt:"serverless-fullstack-application"})),this.state.loading&&o.a.createElement("div",null,o.a.createElement(g,{className:f.a.containerLoading})),!this.state.loading&&o.a.createElement("div",{className:f.a.containerRegister},o.a.createElement("form",{className:f.a.form,onSubmit:this.handleFormSubmit},o.a.createElement("div",{className:f.a.formField},o.a.createElement("label",{className:f.a.formLabel},"Correo electr\xf3nico"),o.a.createElement("input",{type:"text",placeholder:"tucorreo@example.com",className:f.a.formInput,value:this.state.formEmail,onChange:e=>this.handleFormInput("formEmail",e.target.value)})),o.a.createElement("div",{className:f.a.formField},o.a.createElement("label",{className:f.a.formLabel},"Contrase\xf1a"),o.a.createElement("input",{type:"password",placeholder:"tu contrase\xf1a",className:f.a.formInput,value:this.state.formPassword,onChange:e=>this.handleFormInput("formPassword",e.target.value)})),"register"===this.props.authType&&o.a.createElement("div",null,o.a.createElement("div",{className:f.a.formField},o.a.createElement("label",{className:f.a.formLabel},"Nombre de usuario"),o.a.createElement("input",{type:"text",placeholder:"tu nombre de usuario",className:f.a.formInput,value:this.state.formUsername,onChange:e=>this.handleFormInput("formUsername",e.target.value)})),o.a.createElement("div",{className:f.a.formField},o.a.createElement("label",{className:f.a.formLabel},"Rol"),o.a.createElement("input",{type:"text",placeholder:"tu rol",className:f.a.formInput,value:this.state.formRole,onChange:e=>this.handleFormInput("formRole",e.target.value)}))),this.state.formError&&o.a.createElement("div",{className:f.a.formError},this.state.formError),o.a.createElement("button",{className:"buttonPrimaryLarge ".concat(f.a.formButton),type:"submit"},"register"===this.props.authType?"Registrar":"Iniciar sesi\xf3n")),o.a.createElement("div",{className:f.a.switchAuthType},o.a.createElement("span",null,"register"===this.props.authType?"\xbfYa tienes una cuenta?":"\xbfNo tienes una cuenta?"),o.a.createElement("button",{className:"".concat(f.a.switchButton," ").concat(f.a.customButton),onClick:"register"===this.props.authType?this.handleLoginClick:this.handleRegisterClick},"register"===this.props.authType?"Iniciar sesi\xf3n":"Registrarse")))))}}var T=Object(l.g)(C),S=a(10),F=a.n(S);class L extends r.Component{constructor(e){super(e),this.state={},this.logout=this.logout.bind(this)}async componentDidMount(){const e=N();this.setState({session:e})}logout(){y.a.remove("serverless"),console.log("Sesi\xf3n eliminada"),this.props.history.push("/")}render(){return o.a.createElement("div",{className:"".concat(F.a.container," animateFadeIn")},o.a.createElement("div",{className:F.a.containerInner},o.a.createElement("div",{className:F.a.navigationContainer},o.a.createElement("div",{className:"link"},this.state.session?this.state.session.userEmail:""),o.a.createElement("div",{className:"link",onClick:this.logout},"logout")),o.a.createElement("div",{className:"".concat(F.a.contentContainer)},o.a.createElement("div",{className:"".concat(F.a.artwork," animateFlicker")},o.a.createElement("img",{draggable:"false",src:"./fullstack-app-artwork.png",alt:"serverless-fullstack-application"})),o.a.createElement("div",{className:"".concat(F.a.welcomeMessage)},"Bienvenido a tu panel de control de aplicaci\xf3n fullstack sin servidor..."))))}}var R=Object(l.g)(L);class B extends r.Component{constructor(){super(...arguments),this.handleRegister=async(e,t,a,r)=>{try{await(async(e,t,a,r)=>(console.log("Calling requestApi from userRegister with method: ".concat(v.method)),await A("register",v.method,{email:e,password:t,username:a,role:r})))(e,t,a,r),this.props.history.push("/public/users/login")}catch(o){console.error("Error during registration:",o)}},this.handleLogin=async(e,t)=>{try{const a=await(async(e,t)=>(console.log("Calling requestApi from userLogin with method: ".concat(v.method)),await A("login",v.method,{email:e,password:t})))(e,t);k(a.userId,a.userEmail,a.userToken),this.props.history.push("/dashboard")}catch(a){console.error("Error during login:",a)}}}async componentDidMount(){}render(){const e=N();return console.log("App - Session:",e),o.a.createElement(i.a,null,o.a.createElement(l.d,null,o.a.createElement(l.b,{path:"/public/users/register"},o.a.createElement(T,{authType:"register",handleRegister:this.handleRegister})),o.a.createElement(l.b,{path:"/public/users/login"},o.a.createElement(T,{authType:"login",handleLogin:this.handleLogin})),o.a.createElement(D,{path:"/dashboard",component:R,session:e}),o.a.createElement(l.b,{exact:!0,path:"/",component:d}),o.a.createElement(l.b,null,o.a.createElement(l.a,{to:"/"}))))}}const D=e=>{let{component:t,session:a,...r}=e;return o.a.createElement(l.b,Object.assign({},r,{render:e=>a?o.a.createElement(t,e):o.a.createElement(l.a,{to:"/"})}))};var x=B;a(32);s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(x,null)),document.getElementById("root"))},8:function(e,t,a){e.exports={container:"Home_container__3aQQu",containerInner:"Home_containerInner__1cANM",heroArtwork:"Home_heroArtwork__3V3Hj",heroTitle:"Home_heroTitle__ZMf68",heroDescription:"Home_heroDescription__3SzoG",containerCta:"Home_containerCta__pghC2",linkSignIn:"Home_linkSignIn__3ozps"}}},[[19,1,2]]]);
//# sourceMappingURL=main.0d83d6fc.chunk.js.map